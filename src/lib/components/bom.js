
// export const headers = 'PN,Link,Desc,Qty Req,Price EA,Total,Note'.split(',');

export const bomData = [
	{
		PN: 'BiHiKu7N',
		Desc: 'Jinko 540w Solar Panel',
		Qty: 4,
		Price: 189,
		ebayid: null,
		link: 'https://www.santansolar.com/product/new-jinko-bifacial-540w-solar-panel-jkm540m-72hl4tv/'
	},
	{
		Desc: "4' Ground Rod With Clamp",
		Qty: 1,
		Price: 40,
		ebayid: 123325099490,
		link: 'https://ebay.us/Zs4BO3'
	},
	{
		Desc: "15' Ground Wire",
		Qty: 1,
		Price: 12,
		ebayid: 292010027574,
		link: 'https://www.ebay.com/itm/292010027574?amdata=enc%3AAQAJAAAAkCi0pTfUJ%2Buf3%2Fer6gVJo6qNgVkIU6pnr0Y%2FpNawJO7iI0pbOjitwms6%2BO%2FA2bNiDKycuRbzdyVM61OHwqGQoGq1d6peNkUZK4jf0MiOvlN3p0YDvMUsAC1p8ZvxwUE%2FmNJzYjcMOQigrtrP%2BnrFlEYjy6buK13TnCFzR8P6ObKyoZ8WkZpF6qyQuGptyjmIXQ%3D%3D&mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: 'Solar Grounding Lug',
		Qty: 3,
		Price: 6,
		ebayid: 172025600337,
		link: 'https://www.ebay.com/itm/172025600337?mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: 'Shutoff Switch breaker style',
		Qty: 1,
		Price: 44,
		ebayid: 315177701793,
		link: 'https://www.ebay.com/itm/315177701793?amdata=enc%3AAQAJAAAAoGUyaN46%2BaY6awaX57q6yH13V0PaPeNyo4hXTIY68YYel1Hkft33U85%2BvlNZV25pXtVjsL%2BY%2BIkjEhYljj6Hgwlzl7SV%2BsoqJBqmrTzZe11WXxM8%2BVU7XN9Aje0z1fmKzciEczDVKmWrL28kxbqgyKjDAui%2BORyQ2yaqbmESLxMy0qGLgatxPfaz9p2gPlqGeNIe3CnlBRtW8XjSOaI8hkg%3D&mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: 'Shutoff Switch twist style',
		Qty: 1,
		Price: 50,
		ebayid: 235459112866,
		link: 'https://www.ebay.com/itm/235459112866?amdata=enc%3AAQAJAAAAkFiv0Ud50QQTRynOA2fzbYo5d5t09o4LBq%2FvResFUX3kzNQ14g4xXuQSvN3DE%2FrTLeIU4lw4ixDHqEf1aOLsOHIlvn6Uz3LzrwHFxp3eGStG4pVtUsxjBM1N4PiiFNclp9eW7qIS63u5D3XLfTUahLXG6WyNXSLUt%2F%2B%2F8Cu9tfUUCwPkzdIN9AQ9MoutgDACmQ%3D%3D&mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: '3/4" x 50ft  Flexible Non Metallic Conduit kit',
		Qty: 1,
		Price: 50,
		ebayid: 262383880095,
		link: 'https://www.ebay.com/itm/262383880095?mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: 'Solar Mounting Rails',
		Qty: 6,
		Price: 23,
		ebayid: null,
		link: 'https://www.santansolar.com/product/k2-cross-rail-44-x-86-mill/'
	},
	{
		Desc: 'Rail-To-Rail Connector',
		Qty: 4,
		Price: 5,
		ebayid: null,
		link: 'https://www.santansolar.com/product/k2-rail-connector-cross-rail-44-x-mill/'
	},
	{
		Desc: 'Flashing/Mount Kit',
		Qty: 8,
		Price: 9,
		ebayid: null,
		link: 'https://www.santansolar.com/product/k2-everflash-xp-comp-kit-mill/'
	},
	{
		Desc: 'Middle solar clamp bolts',
		Qty: 4,
		Price: 4,
		ebayid: null,
		link: 'https://www.santansolar.com/product/k2-mid-clamp-mil-25-45mm-m8x40/'
	},
	{
		Desc: 'End solar clamp bolts ',
		Qty: 4,
		Price: 4,
		ebayid: null,
		link: 'https://www.santansolar.com/product/k2-end-clamp-silver-25-40mm/'
	},
	{
		Desc: 'Roof to Rail brackets (long for more tilt)',
		Qty: 8,
		Price: 6,
		ebayid: null,
		link: 'https://www.santansolar.com/product/k2-big-foot-6-w-3-chem-link-clip-kit/'
	},
	{
		Desc: 'Stainless Lag bolts for roof mounts',
		Qty: 16,
		Price: 2,
		ebayid: 293494409497,
		link: 'https://www.ebay.com/itm/293494409497?amdata=enc%3AAQAJAAAAkEIqG6O9ynK7abaIuDwtQlMdreHbTGRBwQ8FN3TKYRvrW2JS%2B34NS4TQr%2BSe%2FQWJdTjpiZjLKEeQST%2BGD5EUWRxKuILar62NjluXaaDHMuKmt6kXIriWVWdkcA26oIXdzHuS3I9LDfxkeiOSVbXWG1ckz13Sil05SddN%2BkmG4UolyBGgs%2Bea6uGePsH%2Fbsq4jA%3D%3D&mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: '600v 10 AWG black and red solar wire',
		Qty: 100,
		Price: 1.15,
		ebayid: 235018315902,
		link: 'https://www.ebay.com/itm/235018315902?amdata=enc%3AAQAJAAAAkIvrZP3TaXgE3LfBM4e96%2Ffp1u8Ih0gbUDPIRy54B2rAp2pKTo9NlvQ6xD62nzeDLvXacpO8qmWmTIlJ3tkZm%2FBAR38%2FDxtB0FOvuukN5qsVefKlWAjp6K8FBQS7MLiJVwjPjgQR89fY4pXqQoDPQa2cQ8N5QG3LpWvkwIQFNLWi%2FORhT0YJMI%2BLJ9doU6HPiw%3D%3D&mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: 'Basic MC4 crimper kit',
		Qty: 1,
		Price: 33,
		ebayid: 186178066931,
		link: 'https://www.ebay.com/itm/186178066931?amdata=enc%3AAQAJAAAAkIuSAkIcxfB8CrAO%2FrkTPdjMbwXWYOVO%2B86MC3L5JmPdD4PG%2B%2B7oPJqsXK9IM9RegHDuwaCLOa7GwsRu9EpJWR6qJEqVC4H1WuapGDcEAw9tO3FsMKLrr1mwa%2BEpXMuZWaUDHtso3pT4E%2FqzNIfmfe5j3wY0crB4Sdcu60HYc3rjjAowD6stKyJ6FEZ2h4b8aA%3D%3D&mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	// {
	//     "Desc": "Fancy MC4 crimper kit",
	//     "Qty": 1,
	//     "Price": 95,
	//     "ebayid": 273483825968
	// },
	{
		Desc: 'Thermostatic Mixing Valve',
		Qty: 1,
		Price: 50,
		ebayid: 163916404115,
		link: 'https://www.ebay.com/itm/163916404115?mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: 'Misc copper fittings/elbows',
		Qty: 6,
		Price: 4,
		ebayid: null,
		link: ''
	},
	{
		Desc: '120V 2000W 7.2Ω Water Heater Element ',
		Qty: 1,
		Price: 37,
		ebayid: 186398059270,
		link: 'https://www.ebay.com/itm/186398059270?amdata=enc%3AAQAJAAAAkKg0quUQ2k8hDNt7%2FIcBHA57QU8p6MjHQ%2BrCF%2F2AkRl%2BM7fOguWz4rKuoPv171WUp2xHMiRY%2FzpD%2FUM4qcBAR0Zliv5aL4Y3rIPY83FXvPxYRJh%2BfhMu7MGPAyPHj0oeTHioFRNzcEGXplc%2Fy6CqPlzM08UX%2B%2Fsbjubl7A5GnGahPKIuwPrR2nSQuj2nxY9%2BxA%3D%3D&mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: 'Heater Element Wrench',
		Qty: 1,
		Price: 30,
		ebayid: 333850374625,
		link: 'https://www.ebay.com/itm/333850374625?amdata=enc%3AAQAJAAAAkK%2BR7XoIhkFRcqg1voAaiy5MZJ9qa7grF%2FUXLBQj9iEzNnGjfpl70B0Cbbilpnb4PxHTcTzrxIH1FKX6uBxG6OwgzOnVXOi6QI60wqD5SRJ6ioOAglD%2BA4Rnn%2F0UjxnzQOPVdOvYJnH8nG9XMgcVSOraFpmkPxmFupleq3Rbt3ivKIVTBNZwhJngkw%2FDKamaoQ%3D%3D&mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: 'DC 0-300V Meter ',
		Qty: 1,
		Price: 26,
		ebayid: 145519750249,
		link: 'https://www.ebay.com/itm/145519750249?amdata=enc%3AAQAJAAAAkNAqMZmoSe2aAbjzc333%2BfvHwvSRWxO8w4rV98Gua8xHrDmKOyx0wDwpwWXV0QSj3dkgi1JnsgAlPR49ByaMVhu4Mj8bXgnQ17HufwGopYCY3oce86pTWmW0uuzr8nEBrV8pR0WH0vLjmm0NuWcuzlzSgaOYpG4PeuYuXTBQ0qvxtel71VKVPdx0JcLxHt0NTw%3D%3D&mkcid=1&mkrid=711-53200-19255-0&siteid=0&campid=5339056755&customid=&toolid=10001&mkevt=1'
	},
	{
		Desc: 'MPPT Boiler PV Solar Regulator',
		Qty: 1,
		Price: 370,
		ebayid: 263523458861,
		link: 'https://www.ebay.com/itm/265624377737'
	}
];



export let defaultCellFormat = {		//	if a data cell does not have a format, then this one is used
	"italics":  0,
	"bold":     0,
	"underline":0,
	"fontsize": 13,
	"align":    "left",
	"colour":   "#888",
	"background": "#fff",
	"border":   [false,false,false,false],				//	TLBR
	//"hidden":   false,        //  display format of None
	"readonly": false,
	 displayFormat:'NUMBER2',							//	DATE,TIME, DURATION, CURRENCY2, CURRENCY, TEXT, NUMBER, NUMBER2
  }
  
  export function makeSampleData(data) {
	  makeSampleCellData(data,1,1,'red');
	  makeSampleCellData(data,1,2,'red');
	  makeSampleCellData(data,1,3,'red');
	  makeSampleCellData(data,2,1,'#AAA');
  }
  
  export function makeSampleCellData(data,r,c,col) {
	  data[r][c].format.bold=true;
	  data[r][c].format.colour=col;
	  data[r][c].format.background='#EEE';
	  data[r][c].format.align='center';
	  data[r][c].format.border=[true,false,false,false];
	  data[r][c].value=data[r][c].result=data[r][c].display=Math.random()*9999999|0;	
  }
  
  export function makeDefaultCell(value='',display='',result='') {
	return {
	  value:value,
	  display:display || value,					//	what is displayed often isn't the same as the value. E.G. formulas, 12=>$12.00, -12=>(ý12.00). It is the parents responsibility to do this
	  result:result || value,					//	the result of a formula or just the value as a string/number
	  format:JSON.parse(JSON.stringify(defaultCellFormat)),
	};
  }
  
  export function minSelRow(config) {	return Math.min(config.selCells.row,config.selCells.row2)}
  export function maxSelRow(config) {	return Math.max(config.selCells.row,config.selCells.row2)}
  export function minSelCol(config) {	return Math.min(config.selCells.col,config.selCells.col2)}
  export function maxSelCol(config) {	return Math.max(config.selCells.col,config.selCells.col2)}
  
  
  export function getGridCellOrNull(config, data,r,c) {
	if (r >= data.length || r < 0) return null;
	if ( ! data[r]) {
	  console.log('makeRow() at',r,c);
	  data[r] = [];
	}
	if (c >= data[r].length || c < 0) return null;
	if ( ! data[r][c]) {
	  data[r][c] = makeDefaultCell();
	  console.log('makeDefaultCell()',r,c);
	}
	return data[r][c];
  }
  
  export function makeGridData(config) {
	  let newData=[];
	for(let n=0;n<config.rowSetting.length;n++) {
	  newData[n] = [];
	  if ( ! config.rowSetting[n]) {  //  copy the most recent row
		config.rowSetting[n] = JSON.parse(JSON.stringify(config.rowSetting[n-1]));
	  }
	  for(let c=0;c<config.columnSetting.length;c++) {
		if ( ! config.columnSetting[c]) {  //  copy the most recent column
		  config.columnSetting[c] = JSON.parse(JSON.stringify(config.columnSetting[c-1]));
		}
		let cell = makeDefaultCell();
		newData[n][c] = cell;
	  } 
	}
	return newData;	
  }
  
  
  export let defaultGridConfig = {
		  columnSetting: [
			  {resizable:true, width: 100,},
			  {resizable:true, width: 100,},
			  {resizable:true, width: 200,},
			  {resizable:true, width: 100,},
			  {resizable:true, width: 100,},
			  {resizable:true, width: 100,},
		  ],
		  rowSetting: [
			  {resizable:true, height: 24},
			  {resizable:true, height: 24},
			  {resizable:true, height: 24},
			  {resizable:true, height: 24},
			  {resizable:true, height: 24},
			  {resizable:true, height: 24},
			  {resizable:true, height: 24},
			  {resizable:true, height: 24},
		  ],
	  selCells:{row:0,col:0},
	  editCell:{row:-1,col:-1},
		  defaultFormat : defaultCellFormat,		//	if a data cell does not have a format, then this one is used
	  };
	  
  
  export function makeStringRefFromRowCol(row,col,rowFixed=false,colFixed=false) {
	  let str = colFixed?'$':'';
	  if (col < 0) {
		  console.error('makeStringRefFromRowCol()',row,col,rowFixed,colFixed);
	  } else if (col<26) {		//	A
		  str+=String.fromCharCode(65+col);
	  } else {						//	ZZ
		  str+=String.fromCharCode(65+(col-26)/26|0)+String.fromCharCode(65+col%26);
	  }
	  str+=rowFixed?'$':'';
	  str+=(row+1);
	  return str;
  }
  
  export function makeStringRef(ref) {
	  let str="";
	  if (ref.sheet) str = ref.sheet+'!';
  
	  str += makeStringRefFromRowCol(ref.row,ref.col,ref.rowFixed,ref.colFixed);
  
	  if (ref.row2!=undefined && ref.col2!=undefined
		   && (ref.row2!=ref.row || ref.col2!=ref.col)) {		//	and one of row & col are different
		  str+=':';
		  str += makeStringRefFromRowCol(ref.row2,ref.col2,ref.row2Fixed,ref.col2Fixed);
	  }
	  return str;
  }
  
  //console.log(parseRef("$Z$387:$BB456"));
  export function parseRef(s) {
	  let ref={str:s,error:'No string',rowCnt:0,colCnt:0};
	  if (s==null) return ref;
  
	  let idx=0;
	  
	  //	optional sheet name is in single quotes followed by !  eg 'CF2022'!A1
	  
	  //	single reference
	  if (s[idx]=='$') {	ref.colFixed=true; idx++;	}
	  if (s[idx]>='A' && s[idx] <='Z') {	ref.col=s.charCodeAt(idx) - 65; idx++;	}
	  if (s[idx]>='A' && s[idx] <='Z') {	ref.col=26+ref.col*26+s.charCodeAt(idx) - 65; idx++;}
	  if ( ref.col == undefined) {	ref.error='Bad column'; return ref;}
  
	  if (s[idx]=='$') {	ref.rowFixed=true; idx++;	}
	  let len = 0;
	  while ( s[idx+len] >= '0' && s[idx+len] <= '9') {
		  len++;
	  }
	  let strRow=s.substring(idx,idx+len);
	  //console.log('parseRef',strRow,idx,len);
	  ref.row = Number(strRow);
	  if ( ! ref.row) {	ref.error='Bad row'; return ref;}
  
	  ref.row--;		//	convert to zero based
	  ref.rowCnt=1;
	  ref.colCnt=1;
	  ref.error=null;
  
	  idx+=len;
  
	  //	range
	  if (s[idx]==':') {
		  idx++;		//	skip :
		  if (s[idx]=='$') {	ref.col2Fixed=true; idx++;	}
		  if (s[idx]>='A' && s[idx] <='Z') {	ref.col2=s.charCodeAt(idx) - 65; idx++;	}
		  if (s[idx]>='A' && s[idx] <='Z') {	ref.col2=26+ref.col2*26+s.charCodeAt(idx) - 65; idx++;}
		  if ( ref.col2 == undefined) {	ref.error='Bad column2'; return ref;}
  
		  if (s[idx]=='$') {	ref.row2Fixed=true; idx++;	}
		  len = 0;
		  while ( s[idx+len] >= '0' && s[idx+len] <= '9') {len++;}
		  strRow=s.substring(idx,idx+len);
		  //console.log(strRow,idx,len);
		  ref.row2 = Number(strRow);
		  if ( ! ref.row2) {	ref.error='Bad row2'; return ref;}
		  ref.row2--;		//	convert to zero based
  
		  idx+=len;
  
		  //	rationalise
		  if (ref.row2 < ref.row) {	let tmp = ref.row2; ref.row2 = ref.row; ref.row=tmp; }
		  if (ref.col2 < ref.col) {	let tmp = ref.col2; ref.col2 = ref.col; ref.col=tmp; }
		  ref.rowCnt=ref.row2-ref.row+1;
		  ref.colCnt=ref.col2-ref.col+1;
	  }
	  ref.len=idx;
	  return ref;
  }


  export const headers =  {
    0: makeDefaultCell('PN'),
    1: makeDefaultCell('Link'),
    2: makeDefaultCell('Desc'),
    3: makeDefaultCell('Qty'),
    4: makeDefaultCell('Price'),
    5: makeDefaultCell('Total'),
    6: makeDefaultCell('Note')
};

export function makeBomRow(r){
    return {
        0: makeDefaultCell(''),
        1: makeDefaultCell(r.link),
        2: makeDefaultCell(r.Desc),
        3: makeDefaultCell(r.Qty),
        4: makeDefaultCell(r.Price),
        5: makeDefaultCell(r.Price * r.Qty),
        6: ''
    };
};
